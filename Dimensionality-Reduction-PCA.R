library(stats)           #to use function prcomp()
library(factoextra)      #to use functions get_eig() and fviz_screenplot()
Wine <- read.csv("C:/Users/Me/Desktop/Sem 3/Data Mining/Assignments/Data_Mining/Wine.csv")      #reads the csv file
wine_matrix <- as.matrix(Wine)       #reads the csv file as a matrix
wine.pca <- prcomp(wine_matrix[,2:14])         #gets the table for PCs vs Attributes for all 13 attributes
wine.pca                                       #diplays PCs vs Attributes table
wine.eigen <- get_eig(wine.pca)                #gets the eigenvalues for each PC
wine.eigen                                     #displays eigenvalues
wine.plot <- fviz_screeplot(wine.pca, ncp = 13, linecolor = "red", addlabels=TRUE) + theme_gray()      #plots the bar graph to show the Importance of each PC
wine.plot         #displays the barplot



#TABLE FOR PCs vs ATTRIBUTES
#                 PC1           PC2          PC3          PC4          PC5
#X14.23 -0.0016464031  0.0007166319 -0.018417035 -0.141207907 -0.016866662
#X1.71   0.0006735032  0.0025001779 -0.121896019 -0.160313812  0.616815902
#X2.43  -0.0001948773  0.0046709015 -0.052106139  0.009848420 -0.019752046
#X15.6   0.0046271444  0.0287250643 -0.938281086  0.331947048 -0.062944719
#X127   -0.0174715429  0.9992801054  0.032186047  0.005173260  0.005610088
#X2.8   -0.0009863499  0.0007484732  0.040357265  0.074588860 -0.314757225
#X3.06  -0.0015575348 -0.0004491148  0.084880477  0.169135057 -0.523387659
#X.28    0.0001223031 -0.0013428434 -0.013566798 -0.010786504  0.029717213
#X2.29  -0.0005912858  0.0047111080  0.024002521  0.050216222 -0.249804915
#X5.64  -0.0023300597  0.0154838007 -0.292736147 -0.878512819 -0.331631000
#X1.04  -0.0001708674 -0.0007979233  0.026072208  0.060004447 -0.051812038
#X3.92  -0.0006850453 -0.0043427734  0.068496061  0.178448921 -0.256727053
#X1065  -0.9998302063 -0.0173653604 -0.004503435  0.003115178  0.002292603
#               PC6          PC7           PC8           PC9          PC10
#X14.23  0.190857906 -0.923599698 -2.916309e-01 -6.615858e-02 -3.548615e-03
#X1.71   0.739484660  0.148439828  6.491606e-02 -1.841686e-02 -1.814407e-02
#X2.43   0.041668481 -0.045816409  1.484446e-01 -8.130224e-02 -8.445019e-02
#X15.6  -0.024984199 -0.030424721 -1.506867e-02 -2.238019e-03  3.597246e-03
#X127   -0.001518516 -0.002247297  3.436681e-03  2.468916e-03 -1.409604e-04
#X2.8    0.281973257  0.012032021  1.706091e-01 -2.486031e-01  8.498932e-01
#X3.06   0.438073743  0.029518540  2.405978e-01 -3.859621e-01 -5.162056e-01
#X.28   -0.022353206  0.005465204 -6.482046e-03 -4.041961e-02  3.911001e-02
#X2.29   0.243437316  0.314104819 -8.678638e-01  6.486000e-02  8.423359e-03
#X5.64   0.004658713  0.113187266  8.366982e-02  9.620884e-02 -2.399143e-02
#X1.04  -0.023310064 -0.031909969  1.819775e-03 -3.113806e-02 -3.860731e-02
#X3.92   0.287449896 -0.091437125  2.030626e-01  8.728265e-01  7.749797e-03
#X1065  -0.001224489  0.001089646  1.352366e-07  4.516736e-05  5.190444e-05
#                PC11          PC12          PC13
#X14.23 -0.0137921427 -1.612594e-02 -9.047753e-03
#X1.71  -0.0233308251  6.740455e-02  1.140845e-02
#X2.43   0.9537701091 -1.334115e-01  1.722987e-01
#X15.6  -0.0529416863  5.517945e-03 -1.739796e-03
#X127   -0.0029473023  5.941899e-04 -2.348778e-03
#X2.8    0.0062519430  4.659242e-03  2.811223e-02
#X3.06  -0.1344622065 -3.679138e-02 -6.866896e-02
#X.28    0.1976484705  1.488168e-01 -9.663687e-01
#X2.29   0.1364547674 -1.361987e-02  1.682009e-02
#X5.64  -0.0093626418  5.023155e-02  4.492290e-03
#X1.04   0.0989492057  9.752111e-01  1.678747e-01
#X3.92   0.0330735957  1.000077e-02 -4.725937e-02
#X1065  -0.0002433867 -9.848302e-05 -3.370282e-05



#EIGENVALUES OF EACH PC
#         eigenvalue   variance.percent    cumulative.variance.percent
#Dim.1  9.918559e+04     9.981074e+01               99.81074
#Dim.2  1.708619e+02     1.719388e-01               99.98268
#Dim.3  9.434550e+00     9.494015e-03               99.99218
#Dim.4  5.019168e+00     5.050804e-03               99.99723
#Dim.5  1.233160e+00     1.240932e-03               99.99847
#Dim.6  8.439492e-01     8.492685e-04               99.99932
#Dim.7  2.783340e-01     2.800883e-04               99.99960
#Dim.8  1.520191e-01     1.529773e-04               99.99975
#Dim.9  1.097830e-01     1.104749e-04               99.99986
#Dim.10 7.205192e-02     7.250605e-05               99.99993
#Dim.11 3.774059e-02     3.797847e-05               99.99997
#Dim.12 2.118293e-02     2.131645e-05               99.99999
#Dim.13 8.210697e-03     8.262448e-06               100.00000



#According to the plot we can see that the percentage of variance explained 
#for the first Principal Component is 99.8% which clearly seems as the most 
#satisfactory component because it accounts for a large proportion of the 
#variability which is required to achieve a good dimensionality reduction.
#So, according to my opinion, I will pick only the first Principal Component
#to represent all 13 attributes for this data in my new data space.